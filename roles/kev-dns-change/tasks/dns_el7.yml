---
- name: set dns for EL 7 based servers with NMCLI
  nmcli:
    conn_name: "{{ ansible_default_ipv4.interface }}"
    type: ethernet	
    dns4: "{{ resolv_nameservers }}"	
    state: present	
  tags: makeitso

- name: activate changes with nmcli
  command: /usr/bin/nmcli connection up "{{ ansible_default_ipv4.interface }}"
  tags: makeitso

- name: debugging to check interface status
  command: /usr/bin/nmcli dev show "{{ ansible_default_ipv4.interface }}"
  register: devshow_output
  tags: debug

- name: debug output of the file
  debug:
    msg: "{{ devshow_output }}"
  tags: debug

- name: debugging to check /etc/resolv.conf
  command: "cat /etc/resolv.conf"
  register: etcresolv_output
  tags: debug

- name: debug output of the file
  debug:
    msg: "{{ etcresolv_output }}"
  tags: debug

